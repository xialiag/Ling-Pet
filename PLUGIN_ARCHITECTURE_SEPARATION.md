# æ’ä»¶ç³»ç»Ÿæ¶æ„åˆ†ç¦»è®¾è®¡

## ğŸ¯ è®¾è®¡åŸåˆ™

æ’ä»¶ç³»ç»Ÿåº”è¯¥ä¸ä¸»é¡¹ç›®ä»£ç å®Œå…¨åˆ†ç¦»ï¼Œé¿å…æ’ä»¶ç›¸å…³ä»£ç æ±¡æŸ“ä¸»é¡¹ç›®çš„æºç ç»“æ„ã€‚

## ğŸ“ ç›®å½•ç»“æ„é‡æ–°è®¾è®¡

### ä¹‹å‰çš„é—®é¢˜ç»“æ„
```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ plugin/              âŒ æ’ä»¶ç»„ä»¶ä¸åº”è¯¥åœ¨ä¸»é¡¹ç›®ä¸­
â”‚   â”‚   â”œâ”€â”€ PluginNavigation.vue
â”‚   â”‚   â””â”€â”€ PluginPageContainer.vue
â”‚   â””â”€â”€ ...
â””â”€â”€ ...

pluginLoader/
â”œâ”€â”€ core/
â””â”€â”€ plugins/
```

### æ­£ç¡®çš„åˆ†ç¦»ç»“æ„
```
src/                         âœ… ä¸»é¡¹ç›®ä»£ç 
â”œâ”€â”€ components/
â”œâ”€â”€ pages/
â”œâ”€â”€ services/
â””â”€â”€ ...

pluginLoader/                âœ… æ’ä»¶ç³»ç»Ÿä»£ç 
â”œâ”€â”€ core/                    # æ’ä»¶æ ¸å¿ƒåŠŸèƒ½
â”‚   â”œâ”€â”€ pluginLoader.ts
â”‚   â”œâ”€â”€ pluginPageManager.ts
â”‚   â”œâ”€â”€ dynamicPageLoader.ts
â”‚   â””â”€â”€ pluginComponentRegistry.ts
â”œâ”€â”€ components/              # æ’ä»¶ç³»ç»Ÿç»„ä»¶
â”‚   â”œâ”€â”€ PluginNavigation.vue
â”‚   â””â”€â”€ PluginPageContainer.vue
â”œâ”€â”€ plugins/                 # å…·ä½“æ’ä»¶
â”‚   â”œâ”€â”€ page-demo/
â”‚   â””â”€â”€ external-page-demo/
â””â”€â”€ types/                   # æ’ä»¶ç±»å‹å®šä¹‰
```

## ğŸ”§ ç»„ä»¶æ³¨å†Œæœºåˆ¶

### 1. æ’ä»¶ç»„ä»¶æ³¨å†Œè¡¨

```typescript
// pluginLoader/core/pluginComponentRegistry.ts
export class PluginComponentRegistry {
  // åŠ¨æ€æ³¨å†Œæ’ä»¶ç³»ç»Ÿç»„ä»¶
  private async registerBuiltinComponents() {
    const PluginNavigation = await import('../components/PluginNavigation.vue')
    this.registerComponent({
      name: 'PluginNavigation',
      component: PluginNavigation.default
    })
  }
}
```

### 2. å…¨å±€ç»„ä»¶æ³¨å†Œ

```typescript
// åœ¨æ’ä»¶ç³»ç»Ÿåˆå§‹åŒ–æ—¶
pluginComponentRegistry.initialize(app)

// ç»„ä»¶è‡ªåŠ¨æ³¨å†Œä¸ºå…¨å±€ç»„ä»¶
app.component('PluginNavigation', PluginNavigationComponent)
app.component('PluginPageContainer', PluginPageContainerComponent)
```

### 3. ä¸»é¡¹ç›®ä¸­ä½¿ç”¨

```vue
<!-- ä¸»é¡¹ç›®ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨æ’ä»¶ç»„ä»¶ -->
<template>
  <div>
    <!-- æ’ä»¶å¯¼èˆªç»„ä»¶ -->
    <PluginNavigation />
    
    <!-- æ’ä»¶é¡µé¢å®¹å™¨ -->
    <PluginPageContainer />
  </div>
</template>
```

## ğŸš€ ä¼˜åŠ¿

### 1. æ¸…æ™°çš„ä»£ç åˆ†ç¦»
- **ä¸»é¡¹ç›®ä»£ç **: åªåŒ…å«æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
- **æ’ä»¶ç³»ç»Ÿä»£ç **: å®Œå…¨ç‹¬ç«‹çš„æ’ä»¶åŠŸèƒ½
- **æ’ä»¶ä»£ç **: å„ä¸ªæ’ä»¶çš„å…·ä½“å®ç°

### 2. æ›´å¥½çš„ç»´æŠ¤æ€§
- æ’ä»¶ç³»ç»Ÿå¯ä»¥ç‹¬ç«‹å¼€å‘å’Œæµ‹è¯•
- ä¸»é¡¹ç›®ä¸ä¼šè¢«æ’ä»¶ä»£ç æ±¡æŸ“
- æ›´å®¹æ˜“è¿›è¡Œç‰ˆæœ¬ç®¡ç†å’Œå‘å¸ƒ

### 3. çµæ´»çš„éƒ¨ç½²
- æ’ä»¶ç³»ç»Ÿå¯ä»¥ä½œä¸ºç‹¬ç«‹æ¨¡å—åˆ†å‘
- æ”¯æŒæ’ä»¶ç³»ç»Ÿçš„çƒ­æ›´æ–°
- å¯ä»¥é€‰æ‹©æ€§åœ°åŒ…å«æˆ–æ’é™¤æ’ä»¶åŠŸèƒ½

### 4. å¼€å‘ä½“éªŒ
- æ’ä»¶å¼€å‘è€…æœ‰æ¸…æ™°çš„å¼€å‘è¾¹ç•Œ
- ä¸»é¡¹ç›®å¼€å‘è€…ä¸éœ€è¦å…³å¿ƒæ’ä»¶å®ç°ç»†èŠ‚
- æ›´å¥½çš„ IDE æ”¯æŒå’Œä»£ç æç¤º

## ğŸ”„ åŠ¨æ€åŠ è½½æœºåˆ¶

### 1. ç»„ä»¶åŠ¨æ€å¯¼å…¥

```typescript
// ä½¿ç”¨åŠ¨æ€å¯¼å…¥é¿å…ç¼–è¯‘æ—¶ä¾èµ–
const PluginNavigation = await import('../components/PluginNavigation.vue')
```

### 2. è¿è¡Œæ—¶æ³¨å†Œ

```typescript
// è¿è¡Œæ—¶æ³¨å†Œç»„ä»¶åˆ° Vue åº”ç”¨
app.component('PluginNavigation', PluginNavigation.default)
```

### 3. æŒ‰éœ€åŠ è½½

```typescript
// åªæœ‰åœ¨éœ€è¦æ—¶æ‰åŠ è½½æ’ä»¶ç»„ä»¶
if (pluginSystemEnabled) {
  await pluginComponentRegistry.initialize(app)
}
```

## ğŸ“¦ æ‰“åŒ…å’Œåˆ†å‘

### 1. ä¸»é¡¹ç›®æ‰“åŒ…
```bash
# ä¸»é¡¹ç›®æ‰“åŒ…ä¸åŒ…å«æ’ä»¶ç³»ç»Ÿ
npm run build:main
```

### 2. æ’ä»¶ç³»ç»Ÿæ‰“åŒ…
```bash
# æ’ä»¶ç³»ç»Ÿç‹¬ç«‹æ‰“åŒ…
npm run build:plugin-system
```

### 3. å®Œæ•´æ‰“åŒ…
```bash
# åŒ…å«æ’ä»¶ç³»ç»Ÿçš„å®Œæ•´æ‰“åŒ…
npm run build
```

## ğŸ› ï¸ å¼€å‘å·¥ä½œæµ

### 1. ä¸»é¡¹ç›®å¼€å‘
```bash
# å¼€å‘ä¸»é¡¹ç›®åŠŸèƒ½
npm run dev:main
```

### 2. æ’ä»¶ç³»ç»Ÿå¼€å‘
```bash
# å¼€å‘æ’ä»¶ç³»ç»ŸåŠŸèƒ½
npm run dev:plugin-system
```

### 3. æ’ä»¶å¼€å‘
```bash
# å¼€å‘å…·ä½“æ’ä»¶
npm run dev:plugin -- plugin-name
```

## ğŸ” è°ƒè¯•å’Œæµ‹è¯•

### 1. ç»„ä»¶æ³¨å†Œè°ƒè¯•
```javascript
// æµè§ˆå™¨æ§åˆ¶å°
__pluginComponentRegistry.getAllComponents()
```

### 2. æ’ä»¶ç³»ç»ŸçŠ¶æ€
```javascript
// æ£€æŸ¥æ’ä»¶ç³»ç»ŸçŠ¶æ€
__pluginLoader.getLoadedPlugins()
__pluginLoader.getPageManager().getPluginPages()
```

### 3. ç»„ä»¶å¯ç”¨æ€§æ£€æŸ¥
```javascript
// æ£€æŸ¥ç»„ä»¶æ˜¯å¦å¯ç”¨
__pluginComponentRegistry.hasComponent('PluginNavigation')
```

## ğŸ¯ æœ€ä½³å®è·µ

### 1. ä¿æŒåˆ†ç¦»
- âŒ ä¸è¦åœ¨ä¸»é¡¹ç›®ä¸­ç›´æ¥å¯¼å…¥æ’ä»¶ä»£ç 
- âœ… é€šè¿‡æ’ä»¶ç³»ç»Ÿ API è¿›è¡Œäº¤äº’

### 2. ä½¿ç”¨åŠ¨æ€å¯¼å…¥
- âŒ ä¸è¦ä½¿ç”¨é™æ€ import å¯¼å…¥æ’ä»¶ç»„ä»¶
- âœ… ä½¿ç”¨åŠ¨æ€ import() è¿›è¡ŒæŒ‰éœ€åŠ è½½

### 3. å…¨å±€æ³¨å†Œ
- âŒ ä¸è¦åœ¨ä¸»é¡¹ç›®ä¸­æ‰‹åŠ¨æ³¨å†Œæ’ä»¶ç»„ä»¶
- âœ… è®©æ’ä»¶ç³»ç»Ÿè‡ªåŠ¨å¤„ç†ç»„ä»¶æ³¨å†Œ

### 4. ç±»å‹å®‰å…¨
- âœ… ä¸ºæ’ä»¶ç»„ä»¶æä¾›å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰
- âœ… ä½¿ç”¨æ¥å£å®šä¹‰ç»„ä»¶çš„ props å’Œäº‹ä»¶

## ğŸ”® æœªæ¥æ‰©å±•

### 1. æ’ä»¶ç»„ä»¶å¸‚åœº
- æ”¯æŒç¬¬ä¸‰æ–¹æ’ä»¶ç»„ä»¶
- ç»„ä»¶ç‰ˆæœ¬ç®¡ç†
- ç»„ä»¶ä¾èµ–è§£æ

### 2. ä¸»é¢˜ç³»ç»Ÿé›†æˆ
- æ’ä»¶ç»„ä»¶æ”¯æŒä¸»é¢˜åˆ‡æ¢
- è‡ªå®šä¹‰æ ·å¼è¦†ç›–
- å“åº”å¼è®¾è®¡é€‚é…

### 3. æ€§èƒ½ä¼˜åŒ–
- ç»„ä»¶æ‡’åŠ è½½
- ç»„ä»¶ç¼“å­˜æœºåˆ¶
- æŒ‰éœ€æ‰“åŒ…ä¼˜åŒ–

---

é€šè¿‡è¿™ç§æ¶æ„åˆ†ç¦»è®¾è®¡ï¼Œæˆ‘ä»¬å®ç°äº†æ’ä»¶ç³»ç»Ÿä¸ä¸»é¡¹ç›®çš„å®Œå…¨è§£è€¦ï¼Œæä¾›äº†æ›´å¥½çš„å¼€å‘ä½“éªŒå’Œç»´æŠ¤æ€§ï¼ŒåŒæ—¶ä¿æŒäº†ç³»ç»Ÿçš„çµæ´»æ€§å’Œæ‰©å±•æ€§ã€‚