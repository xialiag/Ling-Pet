# æ’ä»¶ç¼–è¯‘æ‰“åŒ…å·¥å…· - å®Œæˆæ–‡æ¡£

## âœ… å·²å®ŒæˆåŠŸèƒ½

### 1. æ ¸å¿ƒç¼–è¯‘å·¥å…·

#### compiler.js
- âœ… åŸºäº esbuild çš„å¿«é€Ÿç¼–è¯‘
- âœ… TypeScript/JavaScript æ”¯æŒ
- âœ… ä»£ç æ‰“åŒ…ï¼ˆbundleï¼‰
- âœ… ä»£ç å‹ç¼©ï¼ˆminifyï¼‰
- âœ… Source Map ç”Ÿæˆ
- âœ… Rust åç«¯ç¼–è¯‘æ”¯æŒ
- âœ… èµ„æºæ–‡ä»¶è‡ªåŠ¨å¤åˆ¶
- âœ… ç›‘å¬æ¨¡å¼ï¼ˆwatchï¼‰
- âœ… è·¨å¹³å°æ”¯æŒï¼ˆWindows/macOS/Linuxï¼‰

**ç‰¹æ€§ï¼š**
- è‡ªåŠ¨æ£€æµ‹å…¥å£æ–‡ä»¶ï¼ˆindex.ts/index.jsï¼‰
- æ™ºèƒ½å¤–éƒ¨ä¾èµ–å¤„ç†ï¼ˆvue, pinia, tauri ç­‰ï¼‰
- è‡ªåŠ¨ç”Ÿæˆ package.json
- æ”¯æŒè‡ªå®šä¹‰è¾“å‡ºç›®å½•

### 2. æ‰“åŒ…å·¥å…·

#### packager.js
- âœ… ZIP å‹ç¼©æ‰“åŒ…
- âœ… SHA256 æ ¡éªŒå’Œç”Ÿæˆ
- âœ… å…ƒæ•°æ®æ–‡ä»¶ç”Ÿæˆ
- âœ… æ’ä»¶å®Œæ•´æ€§éªŒè¯
- âœ… æ–‡ä»¶å¤§å°ç»Ÿè®¡
- âœ… ç‰ˆæœ¬ç®¡ç†

**è¾“å‡ºæ ¼å¼ï¼š**
```
releases/plugins/
â”œâ”€â”€ plugin-name-1.0.0.zip    # å‹ç¼©åŒ…
â””â”€â”€ plugin-name-1.0.0.json   # å…ƒæ•°æ®
```

**å…ƒæ•°æ®åŒ…å«ï¼š**
- æ’ä»¶åŸºæœ¬ä¿¡æ¯ï¼ˆåç§°ã€ç‰ˆæœ¬ã€æè¿°ï¼‰
- æ–‡ä»¶ä¿¡æ¯ï¼ˆå¤§å°ã€æ ¡éªŒå’Œï¼‰
- ä¾èµ–åˆ—è¡¨
- æƒé™å£°æ˜
- åˆ›å»ºæ—¶é—´

### 3. æ‰¹é‡æ„å»ºå·¥å…·

#### build-all.js
- âœ… æ‰¹é‡ç¼–è¯‘æ‰€æœ‰æ’ä»¶
- âœ… å¯é€‰è‡ªåŠ¨æ‰“åŒ…
- âœ… æ„å»ºæŠ¥å‘Šå’Œç»Ÿè®¡
- âœ… é”™è¯¯å¤„ç†å’Œæ—¥å¿—
- âœ… è¿‡æ»¤ç¤ºä¾‹æ’ä»¶

**é€‰é¡¹ï¼š**
- `--package` - ç¼–è¯‘åè‡ªåŠ¨æ‰“åŒ…
- `--include-examples` - åŒ…å«ç¤ºä¾‹æ’ä»¶
- `--no-minify` - ä¸å‹ç¼©ä»£ç 
- `--no-sourcemap` - ä¸ç”Ÿæˆ sourcemap

### 4. å¼€å‘ç›‘å¬å·¥å…·

#### dev-watch.js
- âœ… æ–‡ä»¶å˜åŒ–ç›‘å¬
- âœ… è‡ªåŠ¨é‡æ–°ç¼–è¯‘
- âœ… æ™ºèƒ½å»é‡ï¼ˆé¿å…é‡å¤ç¼–è¯‘ï¼‰
- âœ… å®æ—¶ç¼–è¯‘åé¦ˆ
- âœ… æ€§èƒ½ç»Ÿè®¡

**ç›‘å¬èŒƒå›´ï¼š**
- TypeScript/JavaScript æ–‡ä»¶
- Vue ç»„ä»¶
- æ ·å¼æ–‡ä»¶
- é…ç½®æ–‡ä»¶
- Rust æºä»£ç 

**å¿½ç•¥ç›®å½•ï¼š**
- node_modules/
- target/
- dist/
- .git/

### 5. ä»»åŠ¡è¿è¡Œå™¨

#### tasks.js
- âœ… clean - æ¸…ç†æ„å»ºäº§ç‰©
- âœ… install - å®‰è£…æ’ä»¶ä¾èµ–
- âœ… check - æ£€æŸ¥æ’ä»¶å®Œæ•´æ€§
- âœ… build-all - æ„å»ºæ‰€æœ‰æ’ä»¶
- âœ… package-all - æ‰“åŒ…æ‰€æœ‰æ’ä»¶
- âœ… release - å‡†å¤‡å‘å¸ƒ

### 6. CLI å·¥å…·å¢å¼º

#### plugin-cli.js
- âœ… create - åˆ›å»ºæ–°æ’ä»¶
- âœ… build - æ„å»ºæ’ä»¶
- âœ… validate - éªŒè¯æ’ä»¶
- âœ… list - åˆ—å‡ºæ‰€æœ‰æ’ä»¶
- âœ… test - æµ‹è¯•åŠ è½½å™¨

## ğŸ“¦ ä¾èµ–åŒ…

å·²æ·»åŠ åˆ° package.jsonï¼š

```json
{
  "devDependencies": {
    "esbuild": "^0.24.2",      // å¿«é€Ÿç¼–è¯‘å™¨
    "archiver": "^7.0.1",      // ZIP æ‰“åŒ…
    "chokidar": "^4.0.3",      // æ–‡ä»¶ç›‘å¬
    "fs-extra": "^11.2.0"      // æ–‡ä»¶æ“ä½œ
  }
}
```

## ğŸ¯ NPM Scripts

å·²æ·»åŠ åˆ° package.jsonï¼š

```json
{
  "scripts": {
    "plugin:compile": "node pluginLoader/tools/compiler.js",
    "plugin:build": "node pluginLoader/tools/build-all.js",
    "plugin:build:watch": "node pluginLoader/tools/dev-watch.js",
    "plugin:package": "node pluginLoader/tools/build-all.js --package",
    "plugin:clean": "node pluginLoader/tools/tasks.js clean",
    "plugin:check": "node pluginLoader/tools/tasks.js check",
    "plugin:release": "node pluginLoader/tools/tasks.js release"
  }
}
```

## ğŸ“ æ–‡ä»¶ç»“æ„

```
pluginLoader/tools/
â”œâ”€â”€ compiler.js          # ç¼–è¯‘å·¥å…·ï¼ˆæ ¸å¿ƒï¼‰
â”œâ”€â”€ packager.js          # æ‰“åŒ…å·¥å…·
â”œâ”€â”€ build-all.js         # æ‰¹é‡æ„å»º
â”œâ”€â”€ dev-watch.js         # å¼€å‘ç›‘å¬
â”œâ”€â”€ tasks.js             # ä»»åŠ¡è¿è¡Œå™¨
â”œâ”€â”€ plugin-cli.js        # CLI å·¥å…·
â”œâ”€â”€ build-plugin.js      # æ—§ç‰ˆæ„å»ºå·¥å…·ï¼ˆä¿ç•™ï¼‰
â”œâ”€â”€ symbolScanner.ts     # ç¬¦å·æ‰«æå™¨
â”œâ”€â”€ README.md            # å®Œæ•´æ–‡æ¡£
â””â”€â”€ QUICKSTART.md        # å¿«é€Ÿå…¥é—¨
```

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### å¼€å‘å•ä¸ªæ’ä»¶

```bash
# 1. åˆ›å»ºæ’ä»¶
node pluginLoader/tools/plugin-cli.js create my-plugin

# 2. å¯åŠ¨ç›‘å¬æ¨¡å¼
npm run plugin:build:watch pluginLoader/plugins/my-plugin

# 3. ä¿®æ”¹ä»£ç ï¼Œè‡ªåŠ¨ç¼–è¯‘

# 4. æµ‹è¯•
npm run dev
```

### ç¼–è¯‘æ‰€æœ‰æ’ä»¶

```bash
# ç¼–è¯‘
npm run plugin:build

# ç¼–è¯‘å¹¶æ‰“åŒ…
npm run plugin:package
```

### å‡†å¤‡å‘å¸ƒ

```bash
# ä¸€é”®å‡†å¤‡å‘å¸ƒ
npm run plugin:release

# è¾“å‡ºï¼š
# - dist/plugins/         (ç¼–è¯‘å)
# - releases/plugins/     (æ‰“åŒ…å)
```

## ğŸ”§ å·¥ä½œæµç¨‹

### å¼€å‘æµç¨‹

```
åˆ›å»ºæ’ä»¶ â†’ å¼€å‘ä»£ç  â†’ ç›‘å¬ç¼–è¯‘ â†’ æµ‹è¯• â†’ è°ƒè¯•
   â†“          â†“          â†“         â†“      â†“
plugin-cli  ç¼–è¾‘å™¨   dev-watch   npm run dev
```

### å‘å¸ƒæµç¨‹

```
æ£€æŸ¥ â†’ ç¼–è¯‘ â†’ éªŒè¯ â†’ æ‰“åŒ… â†’ å‘å¸ƒ
  â†“      â†“      â†“      â†“      â†“
check  build  validate package upload
```

### CI/CD æµç¨‹

```bash
# .github/workflows/build-plugins.yml
- npm install
- npm run plugin:check
- npm run plugin:package
- upload releases/plugins/*.zip
```

## ğŸ“Š æ€§èƒ½ç‰¹ç‚¹

### ç¼–è¯‘é€Ÿåº¦

- **esbuild** - æ¯” webpack å¿« 10-100 å€
- **å¢é‡ç¼–è¯‘** - åªç¼–è¯‘å˜åŒ–çš„æ–‡ä»¶
- **å¹¶è¡Œå¤„ç†** - å¤šæ’ä»¶å¹¶è¡Œç¼–è¯‘

### æ‰“åŒ…å¤§å°

- **ä»£ç å‹ç¼©** - minify å‡å°‘ 30-50% ä½“ç§¯
- **Tree Shaking** - ç§»é™¤æœªä½¿ç”¨ä»£ç 
- **å¤–éƒ¨ä¾èµ–** - é¿å…é‡å¤æ‰“åŒ…

### å¼€å‘ä½“éªŒ

- **å³æ—¶åé¦ˆ** - æ–‡ä»¶å˜åŒ–å < 1s å®Œæˆç¼–è¯‘
- **é”™è¯¯æç¤º** - æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯
- **è¿›åº¦æ˜¾ç¤º** - å®æ—¶æ„å»ºè¿›åº¦

## ğŸ¨ ç‰¹è‰²åŠŸèƒ½

### 1. æ™ºèƒ½ä¾èµ–å¤„ç†

è‡ªåŠ¨è¯†åˆ«å¹¶å¤–éƒ¨åŒ–å¸¸ç”¨ä¾èµ–ï¼š
- Vue ç”Ÿæ€ï¼ˆvue, vue-router, piniaï¼‰
- Tauri æ’ä»¶
- PixiJS ç›¸å…³

### 2. è·¨å¹³å°åç«¯ç¼–è¯‘

è‡ªåŠ¨æ£€æµ‹å¹³å°å¹¶ç¼–è¯‘å¯¹åº”çš„åº“æ–‡ä»¶ï¼š
- Windows: `plugin.dll`
- macOS: `libplugin.dylib`
- Linux: `libplugin.so`

### 3. èµ„æºæ–‡ä»¶ç®¡ç†

è‡ªåŠ¨å¤åˆ¶å¸¸ç”¨èµ„æºï¼š
- assets/ - å›¾ç‰‡ã€å›¾æ ‡
- components/ - Vue ç»„ä»¶
- styles/ - æ ·å¼æ–‡ä»¶
- locales/ - å›½é™…åŒ–æ–‡ä»¶

### 4. å¼€å‘æ¨¡å¼ä¼˜åŒ–

ç›‘å¬æ¨¡å¼ç‰¹æ€§ï¼š
- ä¸å‹ç¼©ä»£ç ï¼ˆæ–¹ä¾¿è°ƒè¯•ï¼‰
- ç”Ÿæˆ source map
- æ™ºèƒ½å»é‡ï¼ˆé¿å…é‡å¤ç¼–è¯‘ï¼‰
- å®æ—¶æ€§èƒ½ç»Ÿè®¡

### 5. å‘å¸ƒå‡†å¤‡è‡ªåŠ¨åŒ–

ä¸€é”®å®Œæˆï¼š
- æ¸…ç†æ—§æ„å»º
- æ£€æŸ¥æ’ä»¶å®Œæ•´æ€§
- ç¼–è¯‘æ‰€æœ‰æ’ä»¶
- æ‰“åŒ…ç”Ÿæˆ ZIP
- ç”Ÿæˆå…ƒæ•°æ®å’Œæ ¡éªŒå’Œ

## ğŸ”’ å®‰å…¨ç‰¹æ€§

### 1. æ ¡éªŒå’ŒéªŒè¯

- SHA256 å“ˆå¸Œ
- é˜²æ­¢æ–‡ä»¶ç¯¡æ”¹
- å®Œæ•´æ€§éªŒè¯

### 2. ä¾èµ–éš”ç¦»

- å¤–éƒ¨ä¾èµ–ä¸æ‰“åŒ…
- é¿å…ç‰ˆæœ¬å†²çª
- å‡å°‘å®‰å…¨é£é™©

### 3. æƒé™å£°æ˜

- æ˜ç¡®æƒé™è¦æ±‚
- å…ƒæ•°æ®ä¸­è®°å½•
- å®‰è£…æ—¶éªŒè¯

## ğŸ“š æ–‡æ¡£

### å·²åˆ›å»ºæ–‡æ¡£

1. **README.md** - å®Œæ•´æ–‡æ¡£
   - å·¥å…·è¯´æ˜
   - ä½¿ç”¨æ–¹æ³•
   - é…ç½®é€‰é¡¹
   - æ•…éšœæ’é™¤
   - æœ€ä½³å®è·µ

2. **QUICKSTART.md** - å¿«é€Ÿå…¥é—¨
   - 5 åˆ†é’Ÿä¸Šæ‰‹
   - å¸¸ç”¨å‘½ä»¤
   - å¼€å‘å·¥ä½œæµ
   - å¸¸è§é—®é¢˜

3. **BUILD_TOOLS_COMPLETE.md** - æœ¬æ–‡æ¡£
   - åŠŸèƒ½æ¸…å•
   - ä½¿ç”¨ç¤ºä¾‹
   - æ€§èƒ½ç‰¹ç‚¹
   - å®‰å…¨ç‰¹æ€§

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

### å¯é€‰å¢å¼ºåŠŸèƒ½

1. **TypeScript ç±»å‹æ£€æŸ¥**
   ```bash
   # ç¼–è¯‘å‰æ£€æŸ¥ç±»å‹
   tsc --noEmit
   ```

2. **ä»£ç è´¨é‡æ£€æŸ¥**
   ```bash
   # ESLint æ£€æŸ¥
   eslint plugins/*/
   ```

3. **å•å…ƒæµ‹è¯•**
   ```bash
   # è¿è¡Œæµ‹è¯•
   npm test
   ```

4. **æ€§èƒ½åˆ†æ**
   ```bash
   # åˆ†ææ‰“åŒ…å¤§å°
   esbuild --analyze
   ```

5. **è‡ªåŠ¨åŒ–å‘å¸ƒ**
   ```bash
   # å‘å¸ƒåˆ° npm/registry
   npm publish
   ```

### é›†æˆå»ºè®®

1. **Git Hooks**
   ```bash
   # pre-commit: æ£€æŸ¥ä»£ç 
   # pre-push: è¿è¡Œæµ‹è¯•
   ```

2. **CI/CD**
   ```yaml
   # GitHub Actions
   # GitLab CI
   # Jenkins
   ```

3. **æ’ä»¶å¸‚åœº**
   ```bash
   # è‡ªåŠ¨ä¸Šä¼ åˆ°æ’ä»¶å¸‚åœº
   # ç‰ˆæœ¬ç®¡ç†
   # æ›´æ–°é€šçŸ¥
   ```

## âœ¨ æ€»ç»“

å·²å®Œæˆä¸€å¥—å®Œæ•´çš„æ’ä»¶ç¼–è¯‘æ‰“åŒ…å·¥å…·é“¾ï¼š

âœ… **å¿«é€Ÿç¼–è¯‘** - åŸºäº esbuildï¼Œé€Ÿåº¦æå¿«
âœ… **è‡ªåŠ¨æ‰“åŒ…** - ç”Ÿæˆæ ‡å‡† ZIP æ ¼å¼
âœ… **å¼€å‘å‹å¥½** - ç›‘å¬æ¨¡å¼ï¼Œå³æ—¶åé¦ˆ
âœ… **æ‰¹é‡å¤„ç†** - ä¸€é”®æ„å»ºæ‰€æœ‰æ’ä»¶
âœ… **å®‰å…¨å¯é ** - æ ¡éªŒå’ŒéªŒè¯ï¼Œå®Œæ•´æ€§æ£€æŸ¥
âœ… **æ–‡æ¡£å®Œå–„** - è¯¦ç»†æ–‡æ¡£å’Œå¿«é€Ÿå…¥é—¨
âœ… **è·¨å¹³å°** - Windows/macOS/Linux æ”¯æŒ

ç°åœ¨å¯ä»¥ï¼š
1. é«˜æ•ˆå¼€å‘æ’ä»¶
2. å¿«é€Ÿç¼–è¯‘æ‰“åŒ…
3. å®‰å…¨åˆ†å‘æ’ä»¶
4. è‡ªåŠ¨åŒ–å‘å¸ƒæµç¨‹

## ğŸ“ ä½¿ç”¨å¸®åŠ©

```bash
# æŸ¥çœ‹å¸®åŠ©
node pluginLoader/tools/plugin-cli.js help
node pluginLoader/tools/tasks.js help

# æŸ¥çœ‹æ–‡æ¡£
cat pluginLoader/tools/README.md
cat pluginLoader/tools/QUICKSTART.md
```

---

**åˆ›å»ºæ—¶é—´**: 2025-03-10
**ç‰ˆæœ¬**: 1.0.0
**çŠ¶æ€**: âœ… å®Œæˆ
